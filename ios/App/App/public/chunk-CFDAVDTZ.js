import{d as z}from"./chunk-QZBBBBPA.js";import{e as J,g as B,i as j}from"./chunk-FFXK657A.js";var L=J((C,w)=>{"use strict";(function(y,i){typeof w<"u"&&w.exports?w.exports=i():typeof define=="function"&&define.amd?define(i):this[y]=i()})("$script",function(){var y=document,i=y.getElementsByTagName("head")[0],x="string",A=!1,g="push",h="readyState",S="onreadystatechange",f={},a={},c={},s={},p,m;function v(e,t){for(var n=0,l=e.length;n<l;++n)if(!t(e[n]))return A;return 1}function I(e,t){v(e,function(n){return t(n),1})}function r(e,t,n){e=e[g]?e:[e];var l=t&&t.call,o=l?t:n,_=l?e.join(""):t,$=e.length;function U(d){return d.call?d():f[d]}function b(){if(!--$){f[_]=1,o&&o();for(var d in c)v(d.split("|"),U)&&!I(c[d],U)&&(c[d]=[])}}return setTimeout(function(){I(e,function d(u,k){if(u===null)return b();if(!k&&!/^https?:\/\//.test(u)&&p&&(u=u.indexOf(".js")===-1?p+u+".js":p+u),s[u])return _&&(a[_]=1),s[u]==2?b():setTimeout(function(){d(u,!0)},0);s[u]=1,_&&(a[_]=1),N(u,b)})},0),r}function N(e,t){var n=y.createElement("script"),l;n.onload=n.onerror=n[S]=function(){n[h]&&!/^c|loade/.test(n[h])||l||(n.onload=n[S]=null,l=1,s[e]=2,t())},n.async=1,n.src=m?e+(e.indexOf("?")===-1?"?":"&")+m:e,i.insertBefore(n,i.lastChild)}return r.get=N,r.order=function(e,t,n){(function l(o){o=e.shift(),e.length?r(o,l):r(o,t,n)})()},r.path=function(e){p=e},r.urlArgs=function(e){m=e},r.ready=function(e,t,n){e=e[g]?e:[e];var l=[];return!I(e,function(o){f[o]||l[g](o)})&&v(e,function(o){return f[o]})?t():function(o){c[o]=c[o]||[],c[o][g](t),n&&n(l)}(e.join("|")),r},r.done=function(e){r([null],e)},r})});var T=B(L());var P=class extends z{constructor(){super({name:"SignInWithApple",platforms:["web"]}),this.appleScriptUrl="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js",this.isAppleScriptLoaded=!1}authorize(i){return j(this,null,function*(){return new Promise((x,A)=>{i?this.loadSignInWithAppleJS().then(g=>{var h,S,f;this.isAppleScriptLoaded=g,this.isAppleScriptLoaded?(AppleID.auth.init({clientId:i.clientId,redirectURI:i.redirectURI,scope:(h=i.scopes)!==null&&h!==void 0?h:void 0,state:(S=i.state)!==null&&S!==void 0?S:void 0,nonce:(f=i.nonce)!==null&&f!==void 0?f:void 0,usePopup:!0}),AppleID.auth.signIn().then(a=>{var c,s,p,m,v;let I={response:{user:null,email:(c=a.user)===null||c===void 0?void 0:c.email,givenName:(p=(s=a.user)===null||s===void 0?void 0:s.name)===null||p===void 0?void 0:p.firstName,familyName:(v=(m=a.user)===null||m===void 0?void 0:m.name)===null||v===void 0?void 0:v.lastName,identityToken:a.authorization.id_token,authorizationCode:a.authorization.code}};x(I)}).catch(a=>{A(a)})):A("Unable to load Sign in with Apple JS framework.")}):A("No options were provided.")})})}loadSignInWithAppleJS(){return new Promise(i=>{this.isAppleScriptLoaded?i(!0):typeof window!==void 0?T.get(this.appleScriptUrl,()=>i(!0)):i(!1)})}};export{P as SignInWithAppleWeb};
